- description: J&J vaccination + biontech booster 2/1
  t0: '2022-01-01'
  series:
    - time: t0
      vc: janssen1/1
    - time: +P3W
      tc: pcr1
    - time: +P1W
      tc: rat1
    - time: +P4W
      vc: biontech2/1
    - time: +P4W
      tc: pcr2
    - time: +P4W
      tc: rat2
  testCases:
    # Complete J&J vaccination immediately leads to 2G
    - time: janssen1/1
      description: Janssen 1/1 immediately leads to 2G as it could be a recovery vaccination
      assertions:
        admissionState: 2G
        mostRelevantCertificate: janssen1/1
        vaccinationState: COMPLETE_IMMUNIZATION_PENDING
        vaccinationValidFrom: janssen1/1+P15D
        mostRecentVaccination: janssen1/1
        hasBooster: false
        verificationCertificates:
          - certificate: janssen1/1
        walletInfo:
          admissionState:
            visible: true
    # Complete J&J vaccination still no complete immunization after 14 days
    - time: janssen1/1+P14D
      assertions:
        admissionState: 2G
        mostRelevantCertificate: janssen1/1
        vaccinationState: COMPLETE_IMMUNIZATION_PENDING
        vaccinationValidFrom: janssen1/1+P15D
        mostRecentVaccination: janssen1/1
        hasBooster: false
        verificationCertificates:
          - certificate: janssen1/1
    # Complete J&J vaccination valid after 15 days
    - time: janssen1/1+P15D
      assertions:
        admissionState: 2G
        mostRelevantCertificate: janssen1/1
        vaccinationState: COMPLETE_IMMUNIZATION
        vaccinationValidFrom: janssen1/1+P15D
        mostRecentVaccination: janssen1/1
        hasBooster: false
        verificationCertificates:
          - certificate: janssen1/1
        walletInfo:
          admissionState:
            value: 2G
            visible: true
            badgeText:
              de: ^2G$
            titleText:
              de: Status-Nachweis
            subtitleText:
              de: ^2G$
            longText:
              de: erfüllen die 2G-Regel
            faqAnchor: admission_policy
    # Additional valid PCR test changes admission state
    - time: pcr1
      assertions:
        admissionState: 2G_PLUS_PCR
        mostRelevantCertificate: janssen1/1
        vaccinationState: COMPLETE_IMMUNIZATION
        vaccinationValidFrom: janssen1/1+P15D
        mostRecentVaccination: janssen1/1
        hasBooster: false
        verificationCertificates:
          - certificate: janssen1/1
          - certificate: pcr1
    # Additional PCR test older than 72h does not change admission state
    - time: pcr1+P3DT1S
      assertions:
        admissionState: 2G
        mostRelevantCertificate: janssen1/1
        vaccinationState: COMPLETE_IMMUNIZATION
        vaccinationValidFrom: janssen1/1+P15D
        mostRecentVaccination: janssen1/1
        hasBooster: false
        verificationCertificates:
          - certificate: janssen1/1
    # Additional valid RAT test changes admission state
    - time: rat1
      assertions:
        admissionState: 2G_PLUS_RAT
        mostRelevantCertificate: janssen1/1
        vaccinationState: COMPLETE_IMMUNIZATION
        vaccinationValidFrom: janssen1/1+P15D
        mostRecentVaccination: janssen1/1
        hasBooster: false
        verificationCertificates:
          - certificate: janssen1/1
          - certificate: rat1
    # Additional RAT test older than 48h does not change admission state
    - time: rat1+P2DT1S
      assertions:
        admissionState: 2G
        mostRelevantCertificate: janssen1/1
        vaccinationState: COMPLETE_IMMUNIZATION
        vaccinationValidFrom: janssen1/1+P15D
        mostRecentVaccination: janssen1/1
        hasBooster: false
        verificationCertificates:
          - certificate: janssen1/1
    # Booster vaccination is immedeately valid and prioritized
    - time: biontech2/1
      assertions:
        admissionState: 1G
        mostRelevantCertificate: biontech2/1
        vaccinationState: COMPLETE_IMMUNIZATION
        vaccinationValidFrom: janssen1/1+P15D
        mostRecentVaccination: biontech2/1
        hasBooster: true
        verificationCertificates:
          - certificate: biontech2/1
    # Additional valid PCR test changes admission state
    - time: pcr2
      assertions:
        admissionState: 1G_PLUS_PCR
        mostRelevantCertificate: biontech2/1
        vaccinationState: COMPLETE_IMMUNIZATION
        vaccinationValidFrom: janssen1/1+P15D
        mostRecentVaccination: biontech2/1
        hasBooster: true
        verificationCertificates:
          - certificate: biontech2/1
          - certificate: pcr2
        walletInfo:
          admissionState:
            value: 1G_PLUS_PCR
            visible: true
            badgeText:
              de: ^1G\+$
            subtitleText:
              de: ^1G\+ PCR-Test$
            longText:
              de: erfüllen die 1G-Plus-Regel
            faqAnchor: admission_policy
          verification:
            - certificate: biontech2/1
              buttonText:
                de: 2G-Zertifikat
            - certificate: pcr2
              buttonText:
                de: Testzertifikat
    # Additional PCR test older than 72h does not change admission state
    - time: pcr2+P3DT1S
      assertions:
        admissionState: 1G
        mostRelevantCertificate: biontech2/1
        vaccinationState: COMPLETE_IMMUNIZATION
        vaccinationValidFrom: janssen1/1+P15D
        mostRecentVaccination: biontech2/1
        hasBooster: true
        verificationCertificates:
          - certificate: biontech2/1
    # Additional valid RAT test changes admission state
    - time: rat2
      assertions:
        admissionState: 1G_PLUS_RAT
        mostRelevantCertificate: biontech2/1
        vaccinationState: COMPLETE_IMMUNIZATION
        vaccinationValidFrom: janssen1/1+P15D
        mostRecentVaccination: biontech2/1
        hasBooster: true
        verificationCertificates:
          - certificate: biontech2/1
          - certificate: rat2
        walletInfo:
          admissionState:
            value: 1G_PLUS_RAT
            visible: true
            badgeText:
              de: ^1G\+$
            subtitleText:
              de: ^1G\+ Schnelltest$
            longText:
              de: erfüllen die 1G-Plus-Regel, es sei denn, es wird ein PCR-Test
            faqAnchor: admission_policy
    # Additional RAT test older than 48h does not change admission state
    - time: rat2+P2DT1S
      assertions:
        admissionState: 1G
        mostRelevantCertificate: biontech2/1
        vaccinationState: COMPLETE_IMMUNIZATION
        vaccinationValidFrom: janssen1/1+P15D
        mostRecentVaccination: biontech2/1
        hasBooster: true
        verificationCertificates:
          - certificate: biontech2/1
# Same testcases like above, but with second vaccination issued as 2/2 instead of 2/1. This does not lead to a booster
- description: J&J vaccination + biontech booster 2/2 + test
  t0: '2022-01-01'
  series:
    - time: t0
      vc: janssen1/1
    - time: +P4W
      vc: biontech2/2
    - time: +P4W
      tc: pcr1
    - time: +P4W
      tc: rat1
  testCases:
    # Second vaccination is immedeately valid, but not yet prioritized
    - time: biontech2/2
      assertions:
        admissionState: 2G
        mostRelevantCertificate: janssen1/1
        vaccinationState: COMPLETE_IMMUNIZATION
        vaccinationValidFrom: janssen1/1+P15D
        mostRecentVaccination: biontech2/2
        hasBooster: false
        verificationCertificates:
          - certificate: janssen1/1
    # Booster vaccination is valid and prioritized after 15 days
    - time: biontech2/2+P15D
      assertions:
        admissionState: 1G
        mostRelevantCertificate: biontech2/2
        vaccinationState: COMPLETE_IMMUNIZATION
        vaccinationValidFrom: janssen1/1+P15D
        mostRecentVaccination: biontech2/2
        hasBooster: false
        verificationCertificates:
          - certificate: biontech2/2
    # Additional valid PCR test changes admission state
    - time: pcr1
      assertions:
        admissionState: 1G_PLUS_PCR
        mostRelevantCertificate: biontech2/2
        vaccinationState: COMPLETE_IMMUNIZATION
        vaccinationValidFrom: janssen1/1+P15D
        mostRecentVaccination: biontech2/2
        hasBooster: false
        verificationCertificates:
          - certificate: biontech2/2
          - certificate: pcr1
    # Additional PCR test older than 72h does not change admission state
    - time: pcr1+P3DT1S
      assertions:
        admissionState: 1G
        mostRelevantCertificate: biontech2/2
        vaccinationState: COMPLETE_IMMUNIZATION
        vaccinationValidFrom: janssen1/1+P15D
        mostRecentVaccination: biontech2/2
        hasBooster: false
        verificationCertificates:
          - certificate: biontech2/2
    # Additional valid RAT test changes admission state
    - time: rat1
      assertions:
        admissionState: 1G_PLUS_RAT
        mostRelevantCertificate: biontech2/2
        vaccinationState: COMPLETE_IMMUNIZATION
        vaccinationValidFrom: janssen1/1+P15D
        mostRecentVaccination: biontech2/2
        hasBooster: false
        verificationCertificates:
          - certificate: biontech2/2
          - certificate: rat1
    # Additional RAT test older than 48h does not change admission state
    - time: rat1+P2DT1S
      assertions:
        admissionState: 1G
        mostRelevantCertificate: biontech2/2
        vaccinationState: COMPLETE_IMMUNIZATION
        vaccinationValidFrom: janssen1/1+P15D
        mostRecentVaccination: biontech2/2
        hasBooster: false
        verificationCertificates:
          - certificate: biontech2/2
# Booster with J&J
- description: J&J vaccination + J&J booster 2/2 + test
  t0: '2022-01-01'
  series:
    - time: t0
      vc: janssen1/1
    - time: +P4W
      vc: janssen2/2
  testCases:
    # 2nd vaccination is immedeately valid and prioritized
    - time: janssen2/2
      assertions:
        admissionState: 2G
        mostRelevantCertificate: janssen2/2
        vaccinationState: COMPLETE_IMMUNIZATION
        vaccinationValidFrom: janssen1/1+P15D
        mostRecentVaccination: janssen2/2
        hasBooster: false
        verificationCertificates:
          - certificate: janssen2/2
# Reissuance of 2/2 as 2/1 with both DCCs in the wallet
- description: J&J vaccination + J&J booster 2/2 + reissuance as 2/1
  t0: '2022-01-01'
  series:
    - time: t0
      vc: janssen1/1
    - time: t0+P4W
      vc: janssen2/2
    - time: t0+P4W
      vc: janssen2/1
      cwtIat: t0+P6W
  testCases:
    # 2nd vaccination is immedeately valid and prioritized
    - time: janssen2/2
      assertions:
        admissionState: 1G
        mostRelevantCertificate: janssen2/1
        vaccinationState: COMPLETE_IMMUNIZATION
        vaccinationValidFrom: janssen1/1+P15D
        mostRecentVaccination: janssen2/1
        hasBooster: true
        verificationCertificates:
          - certificate: janssen2/1
